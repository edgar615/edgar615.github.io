---
layout: post
title: Http长轮询
date: 2019-07-07
categories:
    - http
comments: true
permalink: http-long-polling.html
---

如果我们想将服务器端的数据在实时推送给WEB客户端时（例如IM，WEB端获取支付结果），一般来说有3种实现

- 短轮询
- 长轮询
- websocket（本文不考虑）

# 短轮询
因为客户端只能主动向服务器端发送请求获取数据,但是要服务端主动发送数据给客户端，就可以在客户端不断的发送请求给服务器端，服务器端不管有没有数据都会返回数据并关闭连接。保持客户端不断发送请求的方法是设置一个定时器不断调用某个函数。

但是短轮询中有大半的请求都是无用的，浪费带宽和服务器资源。

# 长轮询
在长轮询机制中，客户端像传统轮询一样从服务器请求数据。然而，如果服务器没有可以立即返回给客户端的数据，则不会立刻返回一个空结果，而是保持这个请求等待数据到来（或者恰当的超时：小于ajax的超时时间），之后将数据作为结果返回给客户端。



